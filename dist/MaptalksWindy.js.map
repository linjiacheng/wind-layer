{"version":3,"file":"MaptalksWindy.js","sources":["../src/windy/windy.js","../src/maptalks/index.js"],"sourcesContent":["/* eslint-disable */\n\n/*  Global class for simulating the movement of particle through a 1km wind grid\n credit: All the credit for this work goes to: https://github.com/cambecc for creating the repo:\n https://github.com/cambecc/earth. The majority of this code is directly take nfrom there, since its awesome.\n This class takes a canvas element and an array of data (1km GFS from http://www.emc.ncep.noaa.gov/index.php?branch=GFS)\n and then uses a mercator (forward/reverse) projection to correctly map wind vectors in \"map space\".\n The \"start\" method takes the bounds of the map at its current extent and starts the whole gridding,\n interpolation and animation process.\n */\n\nconst Windy = function (params = {}) {\n  this.params = params;\n  const that = this;\n\n  that.canvas = params.canvas;\n\n  var defaultColorScale = [\n    \"rgb(36,104, 180)\",\n    \"rgb(60,157, 194)\",\n    \"rgb(128,205,193 )\",\n    \"rgb(151,218,168 )\",\n    \"rgb(198,231,181)\",\n    \"rgb(238,247,217)\",\n    \"rgb(255,238,159)\",\n    \"rgb(252,217,125)\",\n    \"rgb(255,182,100)\",\n    \"rgb(252,150,75)\",\n    \"rgb(250,112,52)\",\n    \"rgb(245,64,32)\",\n    \"rgb(237,45,28)\",\n    \"rgb(220,24,32)\",\n    \"rgb(180,0,35)\"\n  ];\n\n  var defaultOverlayColorScale = [\n    [193,     [37, 4, 42]],\n    [206,     [41, 10, 130]],\n    [219,     [81, 40, 40]],\n    [233.15,  [192, 37, 149]],  // -40 C/F\n    [255.372, [70, 215, 215]],  // 0 F\n    [273.15,  [21, 84, 187]],   // 0 C\n    [275.15,  [24, 132, 14]],   // just above 0 C\n    [291,     [247, 251, 59]],\n    [298,     [235, 167, 21]],\n    [311,     [230, 71, 39]],\n    [328,     [88, 27, 67]]\n  ];\n\n  var buildParams = function(params) {\n    if (!params.projection) params.projection = 'EPSG:4326';\n    that.MIN_VELOCITY_INTENSITY = params.minVelocity || 0;                      // velocity at which particle intensity is minimum (m/s)\n    that.MAX_VELOCITY_INTENSITY = params.maxVelocity || 10;                     // velocity at which particle intensity is maximum (m/s)\n    that.VELOCITY_SCALE = (params.velocityScale || 0.005) * (Math.pow(window.devicePixelRatio, 1 / 3) || 1); // scale for wind velocity (completely arbitrary--this value looks nice)\n    that.MAX_PARTICLE_AGE = params.particleAge || 90;                         \t // max number of frames a particle is drawn before regeneration\n    that.PARTICLE_LINE_WIDTH = params.lineWidth || 1;                           // line width of a drawn particle\n    that.PARTICLE_MULTIPLIER = params.particleMultiplier || 1 / 300;            // particle count scalar (completely arbitrary--this values looks nice)\n    that.PARTICLE_REDUCTION = (Math.pow(window.devicePixelRatio, 1 / 3) || 1.6);   // multiply particle count for mobiles by this amount\n    that.FRAME_RATE = params.frameRate || 16;\n    that.COLOR_SCALE = params.colorScale || defaultColorScale;\n    that.OVERLAY_COLOR_SCALE = params.overlayColorScale || defaultOverlayColorScale;\n    that.OVERLAY_ALPHA = Math.floor(0.6*255);                                   // overlay transparency (on scale [0, 255])\n  };\n\n  buildParams(params);\n\n  window.FRAME_TIME = 1000 / that.FRAME_RATE;   // desired frames per second\n\n  var NULL_WIND_VECTOR = [NaN, NaN, null];  // singleton for no wind in the form: [u, v, magnitude]\n\n  var builder;\n  var grid;\n  var gridData = that.params.data;\n  var date;\n  var λ0, φ0, Δλ, Δφ, ni, nj;\n  var isWind = true;\n\n  var setData = function (data) {\n    gridData = data;\n  };\n\n  var bilinearInterpolateScalar = function (x, y, g00, g10, g01, g11) {\n    var rx = (1 - x);\n    var ry = (1 - y);\n    return g00 * rx * ry + g10 * x * ry + g01 * rx * y + g11 * x * y;\n  };\n\n  // interpolation for vectors like wind (u,v,m)\n  var bilinearInterpolateVector = function (x, y, g00, g10, g01, g11) {\n    var rx = (1 - x);\n    var ry = (1 - y);\n    var a = rx * ry, b = x * ry, c = rx * y, d = x * y;\n    var u = g00[0] * a + g10[0] * b + g01[0] * c + g11[0] * d;\n    var v = g00[1] * a + g10[1] * b + g01[1] * c + g11[1] * d;\n    return [u, v, Math.sqrt(u * u + v * v)];\n  };\n\n  var createScalarBuilder = function (scalar) {\n    isWind = false;\n    var data = scalar.data;\n    return {\n      header: scalar.header,\n      interpolate: bilinearInterpolateScalar,\n      data: function(i) {\n        return data[i];\n      }\n    }\n  };\n\n  var createWindBuilder = function (uComp, vComp) {\n    isWind = true;\n    var uData = uComp.data, vData = vComp.data;\n    return {\n      header: uComp.header,\n      //recipe: recipeFor(\"wind-\" + uComp.header.surface1Value),\n      data: function (i) {\n        return [uData[i], vData[i]];\n      },\n      interpolate: bilinearInterpolateVector\n    }\n  };\n\n  var createBuilder = function (data) {\n    var uComp = null, vComp = null, scalar = null;\n\n    data.forEach(function (record) {\n      switch (record.header.parameterCategory + \",\" + record.header.parameterNumber) {\n        case \"1,2\":\n        case \"2,2\":\n          uComp = record;\n          break;\n        case \"1,3\":\n        case \"2,3\":\n          vComp = record;\n          break;\n        default:\n          scalar = record;\n      }\n    });\n\n    return scalar != null ? createScalarBuilder(scalar) : createWindBuilder(uComp, vComp);\n  };\n\n  var buildGrid = function (data, callback) {\n\n    builder = createBuilder(data);\n    var header = builder.header;\n\n    λ0 = header.lo1;\n    φ0 = Math.max(header.la2, header.la1);  // the grid's origin (e.g., 0.0E, 90.0N)\n\n    Δλ = header.dx;\n    Δφ = header.dy;    // distance between grid points (e.g., 2.5 deg lon, 2.5 deg lat)\n\n    ni = header.nx;\n    nj = header.ny;    // number of grid points W-E and N-S (e.g., 144 x 73)\n\n    date = new Date(header.refTime);\n    date.setHours(date.getHours() + header.forecastTime);\n\n    // Scan mode 0 assumed. Longitude increases from λ0, and latitude decreases from φ0.\n    // http://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_table3-4.shtml\n    grid = [];\n    var p = 0;\n    var isContinuous = Math.floor(ni * Δλ) >= 360;\n\n    for (var j = 0; j < nj; j++) {\n      var row = [];\n      for (var i = 0; i < ni; i++, p++) {\n        row[i] = builder.data(p);\n      }\n      if (isContinuous) {\n        // For wrapped grids, duplicate first column as last column to simplify interpolation logic\n        row.push(row[0]);\n      }\n      grid[j] = row;\n    }\n\n    callback({\n      date: date,\n      interpolate: interpolate\n    });\n  };\n\n  /**\n   * Get interpolated grid value from Lon/Lat position\n   * @param λ {Float} Longitude\n   * @param φ {Float} Latitude\n   * @returns {Object}\n   */\n  var interpolate = function (λ, φ) {\n\n    if (!grid) return null;\n\n    var i = floorMod(λ - λ0, 360) / Δλ;  // calculate longitude index in wrapped range [0, 360)\n    var j = (φ0 - φ) / Δφ;                 // calculate latitude index in direction +90 to -90\n\n    var fi = Math.floor(i), ci = fi + 1;\n    var fj = Math.floor(j), cj = fj + 1;\n\n    var row;\n    if ((row = grid[fj])) {\n      var g00 = row[fi];\n      var g10 = row[ci];\n      if (isValue(g00) && isValue(g10) && (row = grid[cj])) {\n        var g01 = row[fi];\n        var g11 = row[ci];\n        if (isValue(g01) && isValue(g11)) {\n          // All four points found, so interpolate the value.\n          return builder.interpolate(i - fi, j - fj, g00, g10, g01, g11);\n        }\n      }\n    }\n    return null;\n  };\n\n  /**\n   * @returns {Boolean} true if the specified value is not null and not undefined.\n   */\n  var isValue = function (x) {\n    return x !== null && x !== undefined;\n  };\n\n  /**\n   * @returns {Number} returns remainder of floored division, i.e., floor(a / n). Useful for consistent modulo\n   *          of negative numbers. See http://en.wikipedia.org/wiki/Modulo_operation.\n   */\n  var floorMod = function (a, n) {\n    return a - n * Math.floor(a / n);\n  };\n\n  /**\n   * @returns {Number} the value x clamped to the range [low, high].\n   */\n  var clamp = function (x, range) {\n    return Math.max(range[0], Math.min(x, range[1]));\n  };\n\n  /**\n   * @returns {number} the fraction of the bounds [low, high] covered by the value x, after clamping x to the\n   *          bounds. For example, given bounds=[10, 20], this method returns 1 for x>=20, 0.5 for x=15 and 0\n   *          for x<=10.\n   */\n  var proportion = function (x, low, high) {\n    return (clamp(x, [low, high]) - low) / (high - low);\n  }\n  /**\n   * @returns {Boolean} true if agent is probably a mobile device. Don't really care if this is accurate.\n   */\n  var isMobile = function () {\n    return (/android|blackberry|iemobile|ipad|iphone|ipod|opera mini|webos/i).test(navigator.userAgent);\n  };\n\n\n  var colorInterpolator = function (start, end) {\n    var r = start[0], g = start[1], b = start[2];\n    var Δr = end[0] - r, Δg = end[1] - g, Δb = end[2] - b;\n    return function(i, a) {\n        return [Math.floor(r + i * Δr), Math.floor(g + i * Δg), Math.floor(b + i * Δb), a];\n    };\n  }\n\n  /**\n   * Creates a color scale composed of the specified segments. Segments is an array of two-element arrays of the\n   * form [value, color], where value is the point along the scale and color is the [r, g, b] color at that point.\n   * For example, the following creates a scale that smoothly transitions from red to green to blue along the\n   * points 0.5, 1.0, and 3.5:\n   *\n   *     [ [ 0.5, [255, 0, 0] ],\n   *       [ 1.0, [0, 255, 0] ],\n   *       [ 3.5, [0, 0, 255] ] ]\n   *\n   * @param segments array of color segments\n   * @returns {Function} a function(point, alpha) that returns the color [r, g, b, alpha] for the given point.\n   */\n  function segmentedColorScale(segments) {\n    var points = [], interpolators = [], ranges = [];\n    for (var i = 0; i < segments.length - 1; i++) {\n        points.push(segments[i+1][0]);\n        interpolators.push(colorInterpolator(segments[i][1], segments[i+1][1]));\n        ranges.push([segments[i][0], segments[i+1][0]]);\n    }\n\n    return function(point, alpha) {\n        var i;\n        for (i = 0; i < points.length - 1; i++) {\n            if (point <= points[i]) {\n                break;\n            }\n        }\n        var range = ranges[i];\n        return interpolators[i](proportion(point, range[0], range[1]), alpha);\n    };\n  }\n\n  /**\n   * Calculate distortion of the wind vector caused by the shape of the projection at point (x, y). The wind\n   * vector is modified in place and returned by this function.\n   */\n  var distort = function (projection, λ, φ, x, y, scale, wind, windy) {\n    var u = wind[0] * scale;\n    var v = wind[1] * scale;\n    var d = distortion(projection, λ, φ, x, y, windy);\n\n    // Scale distortion vectors by u and v, then add.\n    wind[0] = d[0] * u + d[2] * v;\n    wind[1] = d[1] * u + d[3] * v;\n    return wind;\n  };\n\n  var distortion = function (projection, λ, φ, x, y, windy) {\n    var τ = 2 * Math.PI;\n    // var H = Math.pow(10, -5.2);\n    var H = that.params.projection === 'EPSG:4326' ? 5 : Math.pow(10, -5.2);\n    var hλ = λ < 0 ? H : -H;\n    var hφ = φ < 0 ? H : -H;\n\n    var pλ = project(φ, λ + hλ, windy);\n    var pφ = project(φ + hφ, λ, windy);\n\n    // Meridian scale factor (see Snyder, equation 4-3), where R = 1. This handles issue where length of 1º λ\n    // changes depending on φ. Without this, there is a pinching effect at the poles.\n    var k = Math.cos(φ / 360 * τ);\n    return [\n      (pλ[0] - x) / hλ / k,\n      (pλ[1] - y) / hλ / k,\n      (pφ[0] - x) / hφ,\n      (pφ[1] - y) / hφ\n    ];\n  };\n\n  var createMask = function (bounds) {\n    var canvas = document.createElement('canvas');\n    var width = bounds.width;\n    var height = bounds.height;\n    canvas.width = width;\n    canvas.height = height;\n    var context = canvas.getContext(\"2d\");\n    context.fillStyle = \"rgba(255, 0, 0, 1)\";\n    context.fill();\n\n    var imageData = context.getImageData(0, 0, width, height);\n    var data = imageData.data;  // layout: [r, g, b, a, r, g, b, a, ...]\n    return {\n        imageData: imageData,\n        isVisible: function(x, y) {\n            var i = (y * width + x) * 4;\n            return data[i + 3] > 0;  // non-zero alpha means pixel is visible\n        },\n        set: function(x, y, rgba) {\n            var i = (y * width + x) * 4;\n            data[i    ] = rgba[0];\n            data[i + 1] = rgba[1];\n            data[i + 2] = rgba[2];\n            data[i + 3] = rgba[3];\n            return this;\n        }\n    };\n  };\n\n  var createField = function (columns, bounds, mask, callback) {\n\n    /**\n     * @returns {Array} wind vector [u, v, magnitude] at the point (x, y), or [NaN, NaN, null] if wind\n     *          is undefined at that point.\n     */\n    function field (x, y) {\n      var column = columns[Math.round(x)];\n      return column && column[Math.round(y)] || NULL_WIND_VECTOR;\n    }\n\n    // Frees the massive \"columns\" array for GC. Without this, the array is leaked (in Chrome) each time a new\n    // field is interpolated because the field closure's context is leaked, for reasons that defy explanation.\n    field.release = function () {\n      columns = [];\n    };\n\n    field.randomize = function (o) {  // UNDONE: this method is terrible\n      var x, y;\n      var safetyNet = 0;\n      do {\n        x = Math.round(Math.floor(Math.random() * bounds.width) + bounds.x);\n        y = Math.round(Math.floor(Math.random() * bounds.height) + bounds.y)\n      } while (field(x, y)[2] === null && safetyNet++ < 30);\n      o.x = x;\n      o.y = y;\n      return o;\n    };\n\n    field.overlay = mask.imageData;\n\n    callback(bounds, field);\n  };\n\n  var buildBounds = function (bounds, width, height) {\n    var upperLeft = bounds[0];\n    var lowerRight = bounds[1];\n    var x = Math.round(upperLeft[0]); //Math.max(Math.floor(upperLeft[0], 0), 0);\n    var y = Math.max(Math.floor(upperLeft[1], 0), 0);\n    var xMax = Math.min(Math.ceil(lowerRight[0], width), width - 1);\n    var yMax = Math.min(Math.ceil(lowerRight[1], height), height - 1);\n    return {x: x, y: y, xMax: width, yMax: yMax, width: width, height: height};\n  };\n\n  var deg2rad = function (deg) {\n    return (deg / 180) * Math.PI;\n  };\n\n  var rad2deg = function (ang) {\n    return ang / (Math.PI / 180.0);\n  };\n\n  var invert\n\n  if (that.params.projection === 'EPSG:4326') {\n    invert = function (x, y, windy) {\n      var mapLonDelta = windy.east - windy.west;\n      var mapLatDelta = windy.south - windy.north;\n      var lat = rad2deg(windy.north) + y / windy.height * rad2deg(mapLatDelta);\n      var lon = rad2deg(windy.west) + x / windy.width * rad2deg(mapLonDelta);\n      return [lon, lat];\n    };\n  } else {\n    invert = function (x, y, windy) {\n      var mapLonDelta = windy.east - windy.west;\n      var worldMapRadius = windy.width / rad2deg(mapLonDelta) * 360 / (2 * Math.PI);\n      var mapOffsetY = (worldMapRadius / 2 * Math.log((1 + Math.sin(windy.south)) / (1 - Math.sin(windy.south))));\n      var equatorY = windy.height + mapOffsetY;\n      var a = (equatorY - y) / worldMapRadius;\n      var lat = 180 / Math.PI * (2 * Math.atan(Math.exp(a)) - Math.PI / 2);\n      var lon = rad2deg(windy.west) + x / windy.width * rad2deg(mapLonDelta);\n      return [lon, lat];\n    };\n  }\n\n  var mercY = function (lat) {\n    return Math.log(Math.tan(lat / 2 + Math.PI / 4));\n  };\n\n\n  var project = function (lat, lon, windy) { // both in radians, use deg2rad if neccessary\n    var ymin = mercY(windy.south);\n    var ymax = mercY(windy.north);\n    var xFactor = windy.width / (windy.east - windy.west);\n    var yFactor = windy.height / (ymax - ymin);\n\n    var y = mercY(deg2rad(lat));\n    var x = (deg2rad(lon) - windy.west) * xFactor;\n    var y = (ymax - y) * yFactor; // y points south\n    return [x, y];\n  };\n\n  var interpolateField = function (grid, bounds, extent, callback) {\n\n    var mask = createMask(bounds);\n\n    var projection = {};\n    var mapArea = ((extent.south - extent.north) * (extent.west - extent.east));\n    var velocityScale = that.VELOCITY_SCALE * Math.pow(mapArea, 0.4);\n\n    var columns = [];\n    var x = bounds.x;\n\n    function interpolateColumn (x) {\n      var column = [];\n      for (var y = bounds.y; y <= bounds.yMax; y += 2) {\n        var coord = invert(x, y, extent);\n        var color = [0, 0, 0, 0];\n        if (coord) {\n          var λ = coord[0], φ = coord[1];\n          if (isFinite(λ)) {\n            var wind = grid.interpolate(λ, φ);\n            var scalar = null;\n            if (wind) {\n              if (isWind) {\n                wind = distort(projection, λ, φ, x, y, velocityScale, wind, extent);\n                column[y + 1] = column[y] = wind;\n              }\n              else {\n                scalar = wind;\n              }\n            }\n            if(isValue(scalar)) {\n              color = (segmentedColorScale(that.OVERLAY_COLOR_SCALE))(scalar, OVERLAY_ALPHA);\n            }\n          }\n        }\n        mask.set(x, y, color).set(x+1, y, color).set(x, y+1, color).set(x+1, y+1, color);\n      }\n      columns[x + 1] = columns[x] = column;\n    }\n\n    (function batchInterpolate () {\n      var start = Date.now();\n      while (x < bounds.width) {\n        interpolateColumn(x);\n        x += 2;\n        if ((Date.now() - start) > 1000) { //MAX_TASK_TIME) {\n          setTimeout(batchInterpolate, 25);\n          return;\n        }\n      }\n      createField(columns, bounds, mask, callback);\n    })();\n  };\n\n  var animationLoop;\n  var animate = function (bounds, field) {\n\n    function windIntensityColorScale (min, max) {\n\n      that.COLOR_SCALE.indexFor = function (m) {  // map velocity speed to a style\n        return Math.max(0, Math.min((that.COLOR_SCALE.length - 1),\n          Math.round((m - min) / (max - min) * (that.COLOR_SCALE.length - 1))));\n\n      };\n\n      return that.COLOR_SCALE;\n    }\n\n    var colorStyles = windIntensityColorScale(that.MIN_VELOCITY_INTENSITY, that.MAX_VELOCITY_INTENSITY);\n    var buckets = colorStyles.map(function () {\n      return [];\n    });\n\n    var particleCount = Math.round(bounds.width * bounds.height * that.PARTICLE_MULTIPLIER);\n    if (isMobile()) {\n      particleCount *= that.PARTICLE_REDUCTION;\n    }\n\n    var fadeFillStyle = \"rgba(0, 0, 0, 0.97)\";\n\n    var particles = [];\n    for (var i = 0; i < particleCount; i++) {\n      particles.push(field.randomize({age: Math.floor(Math.random() * that.MAX_PARTICLE_AGE) + 0}));\n    }\n\n    function evolve () {\n      buckets.forEach(function (bucket) {\n        bucket.length = 0;\n      });\n      particles.forEach(function (particle) {\n        if (particle.age > that.MAX_PARTICLE_AGE) {\n          field.randomize(particle).age = 0;\n        }\n        var x = particle.x;\n        var y = particle.y;\n        var v = field(x, y);  // vector at current position\n        var m = v[2];\n        if (m === null) {\n          particle.age = that.MAX_PARTICLE_AGE;  // particle has escaped the grid, never to return...\n        }\n        else {\n          var xt = x + v[0];\n          var yt = y + v[1];\n          if (field(xt, yt)[2] !== null) {\n            // Path from (x,y) to (xt,yt) is visible, so add this particle to the appropriate draw bucket.\n            particle.xt = xt;\n            particle.yt = yt;\n            buckets[colorStyles.indexFor(m)].push(particle);\n          }\n          else {\n            // Particle isn't visible, but it still moves through the field.\n            particle.x = xt;\n            particle.y = yt;\n          }\n        }\n        particle.age += 1;\n      });\n    }\n\n    var g = that.canvas.getContext(\"2d\");\n    g.lineWidth = that.PARTICLE_LINE_WIDTH;\n    g.fillStyle = fadeFillStyle;\n    g.globalAlpha = 0.6;\n\n    function draw () {\n      // Fade existing particle trails.\n      var prev = \"lighter\";\n      g.globalCompositeOperation = \"destination-in\";\n      g.fillRect(bounds.x, bounds.y, bounds.width, bounds.height);\n      g.globalCompositeOperation = prev;\n      g.globalAlpha = 0.9;\n\n      // Draw new particle trails.\n      buckets.forEach(function (bucket, i) {\n        if (bucket.length > 0) {\n          g.beginPath();\n          g.strokeStyle = colorStyles[i];\n          bucket.forEach(function (particle) {\n            g.moveTo(particle.x, particle.y);\n            g.lineTo(particle.xt, particle.yt);\n            particle.x = particle.xt;\n            particle.y = particle.yt;\n          });\n          g.stroke();\n        }\n      });\n    }\n\n    var then = Date.now();\n    (function frame () {\n      animationLoop = requestAnimationFrame(frame);\n      var now = Date.now();\n      var delta = now - then;\n      if (delta > FRAME_TIME) {\n        then = now - (delta % FRAME_TIME);\n        evolve();\n        draw();\n        params.onDraw && params.onDraw();\n      }\n    })();\n  };\n\n  var overlay = function (bounds, field) {\n    if (!field) return;\n\n    var canvas = params.canvas, w = canvas.width, h = canvas.height, ctx = canvas.getContext(\"2d\");\n    ctx.clearRect(0, 0, w, h);\n    ctx.putImageData(field.overlay, 0, 0);\n  }\n\n  var updateData = function (data, bounds, width, height, extent) {\n    delete that.params.data;\n    that.params.data = data;\n    if (extent)\n      start(bounds, width, height, extent);\n  };\n\n  var start = function (bounds, width, height, extent) {\n    var mapBounds = {\n      south: deg2rad(extent[0][1]),\n      north: deg2rad(extent[1][1]),\n      east: deg2rad(extent[1][0]),\n      west: deg2rad(extent[0][0]),\n      width: width,\n      height: height\n    };\n\n    stop();\n\n    // build grid\n    buildGrid(gridData, function (grid) {\n      // interpolateField\n      interpolateField(grid, buildBounds(bounds, width, height), mapBounds, function (bounds, field) {\n        // animate the canvas with random points\n        windy.field = field;\n        if(isWind) {\n          animate(bounds, field);\n        }\n        else {\n          overlay(bounds, field);\n        }\n        \n      });\n\n    });\n  };\n\n  var stop = function () {\n    if (windy.field) windy.field.release();\n    if (animationLoop) cancelAnimationFrame(animationLoop);\n  };\n\n  var shift = function (dx, dy) {\n    var canvas = that.canvas, w = canvas.width, h = canvas.height, ctx = canvas.getContext(\"2d\");\n    if (w > dx && h > dy) {\n      var clamp = function (high, value) {\n        return Math.max(0, Math.min(high, value));\n      };\n      var imageData = ctx.getImageData(clamp(w, -dx), clamp(h, -dy), clamp(w, w - dx), clamp(h, h - dy));\n      ctx.clearRect(0, 0, w, h);\n      ctx.putImageData(imageData, clamp(w, dx), clamp(h, dy));\n      for (var i = 0, pLength = particles.length; i < pLength; i++) {\n        particles[i].x += dx;\n        particles[i].y += dy;\n      }\n    }\n  };\n\n  var updateParams = function(params) {\n    that.params = params;\n    buildParams(that.params);\n  };\n\n  var getParams = function() {\n    return that.params;\n  };\n\n  var windy = {\n    params: that.params,\n    start: start,\n    stop: stop,\n    update: updateData,\n    shift: shift,\n    createField: createField,\n    interpolatePoint: interpolate,\n    setData: setData,\n    updateParams: updateParams,\n    getParams: getParams,\n    buildParams: buildParams,\n  };\n\n  return windy;\n};\n\n// polyfill\nwindow.requestAnimationFrame = (function () {\n  return window.requestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function (callback) {\n      return window.setTimeout(callback, 1000 / window.FRAME_RATE);\n    };\n})();\n\nif (!window.cancelAnimationFrame) {\n  window.cancelAnimationFrame = function (id) {\n    clearTimeout(id);\n  };\n}\n\nexport default Windy\n","import { Layer, renderer, SpatialReference } from 'maptalks';\nimport Windy from '../windy/windy';\n\nconst defaultConfig = {\n  minVelocity: 0, // 粒子强度最小的速度 (m/s)\n  maxVelocity: 10, // 粒子强度最大的速度 (m/s)\n  velocityScale: 0.05, // 风速的比例\n  particleAge: 90, // 重绘之前生成的离子数量的最大帧数\n  lineWidth: 1, // 绘制粒子的线宽\n  particleMultiplier: 1 / 300, // 离子数量\n  colorScale: undefined,\n  animate: true\n};\n\nclass Renderer extends renderer.CanvasRenderer {\n  _initialize () {\n    const map = this.getMap();\n    const params = this.layer.getParams();\n    let sr = this.layer.getSpatialReference();\n    if (!sr) {\n      sr = map.getSpatialReference();\n    }\n    const proj = sr.getProjection();\n    this._windy = new Windy({\n      canvas: this.canvas,\n      data: this.layer.getData(),\n      projection: proj.code || 'EPSG:4326',\n      onDraw: () => {\n        this.setCanvasUpdated();\n      },\n      ...params\n    });\n  }\n\n  draw () {\n    const extent = this._getWindExtents();\n    this.prepareCanvas();\n    if (!this._windy) {\n      this._initialize();\n    }\n    this._windy && this._windy.start(...extent);\n  }\n\n  _redraw () {\n    this.prepareRender();\n    this.draw();\n  }\n\n  drawOnInteracting () {\n    // nothing to draw when interacting\n  }\n\n  _getWindExtents () {\n    const map = this.getMap();\n    if (!map) return null;\n    const extent = map.getExtent();\n    const xmin = extent.xmin;\n    const xmax = extent.xmax > 0 ? extent.xmax : 360 + extent.xmax;\n    const ymin = extent.ymin;\n    const ymax = extent.ymax;\n    return [\n      [[0, 0], [map.width, map.height]],\n      map.width,\n      map.height,\n      [[\n        xmin,\n        ymin\n      ], [\n        xmax,\n        ymax\n      ]]\n    ];\n  }\n\n  _updateParams () {\n    if (this._windy) {\n      const params = this.layer.getParams();\n      this._windy.updateParams(params);\n      this.draw();\n    }\n  }\n\n  /**\n   * tell layer redraw\n   * @returns {*}\n   */\n  needToRedraw () {\n    const map = this.getMap();\n    if (map.isZooming() && !map.getPitch()) {\n      return false;\n    }\n    return super.needToRedraw();\n  }\n\n  onZoomStart () {\n    // this._windy && this._windy.stop();\n    // eslint-disable-next-line prefer-rest-params\n    super.onZoomStart.apply(this, arguments);\n  }\n\n  onZoomEnd () {\n    // eslint-disable-next-line prefer-rest-params\n    super.onZoomEnd.apply(this, arguments);\n  }\n\n  onDragRotateStart () {\n    // this._windy && this._windy.stop();\n  }\n\n  onMoveStart () {\n    // this._windy && this._windy.stop();\n  }\n\n  remove () {\n    if (this._windy) {\n      this._windy.stop();\n      delete this._windy;\n    }\n    super.remove();\n  }\n}\n\nclass MaptalksWindy extends Layer {\n  constructor (id, data, options) {\n    super(id, Object.assign(defaultConfig, options));\n    this._data = data;\n  }\n\n  getData () {\n    return this._data;\n  }\n\n  setData (data) {\n    this._data = data;\n    this.redraw();\n    return this;\n  }\n\n  updateParams (params) {\n    const renderer = this._getRenderer();\n    this.options = Object.assign(this.options, params);\n    if (renderer) {\n      const {\n        minVelocity, // 粒子强度最小的速度 (m/s)\n        maxVelocity, // 粒子强度最大的速度 (m/s)\n        velocityScale, // 风速的比例\n        particleAge, // 重绘之前生成的离子数量的最大帧数\n        lineWidth, // 绘制粒子的线宽\n        particleMultiplier, // 离子数量\n        colorScale\n      } = this.options;\n      renderer._updateParams({\n        minVelocity, // 粒子强度最小的速度 (m/s)\n        maxVelocity, // 粒子强度最大的速度 (m/s)\n        velocityScale, // 风速的比例\n        particleAge, // 重绘之前生成的离子数量的最大帧数\n        lineWidth, // 绘制粒子的线宽\n        particleMultiplier, // 离子数量\n        colorScale\n      });\n    }\n    return this;\n  }\n\n  getParams () {\n    const {\n      minVelocity,\n      maxVelocity,\n      velocityScale,\n      particleAge,\n      lineWidth,\n      particleMultiplier,\n      colorScale\n    } = this.options;\n    return {\n      minVelocity,\n      maxVelocity,\n      velocityScale,\n      particleAge,\n      lineWidth,\n      particleMultiplier,\n      colorScale\n    };\n  }\n\n  onResize () {}\n\n  onZoomStart () {}\n\n  onZooming () {}\n\n  onZoomEnd () {}\n\n  onMoveStart () {}\n\n  onMoving () {}\n\n  onMoveEnd () {}\n\n  redraw () {\n    const renderer = this._getRenderer();\n    if (renderer) {\n      renderer._redraw();\n    }\n    return this;\n  }\n\n  toJSON () {\n    return {\n      type: 'MaptalksWindy',\n      id: this.getId(),\n      options: this.config(),\n      data: this.getData()\n    };\n  }\n\n  getSpatialReference () {\n    const map = this.getMap();\n    if (map && (!this.options.spatialReference || SpatialReference.equals(this.options.spatialReference, map.options.spatialReference))) {\n      return map.getSpatialReference();\n    }\n    this._sr = this._sr || new SpatialReference(this.options.spatialReference);\n    return this._sr;\n  }\n\n  static fromJSON (json) {\n    if (!json || json.type !== 'MaptalksWindy') { return null; }\n    // eslint-disable-next-line new-cap\n    const layer = new MaptalksWindy(json.id, json.data, json.options);\n    return layer;\n  }\n}\n\nMaptalksWindy.registerRenderer('canvas', Renderer);\n\nexport default MaptalksWindy;\n"],"names":["const","let","this","super","renderer","SpatialReference","Layer"],"mappings":"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"}